<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CONAPREV 83 — Inscrições</title>
  <meta name="description" content="Inscrições da 83ª Reunião Ordinária do CONAPREV. Informações, hospedagem, ofício de convocação e emissão de certificado." />

  <!-- Tipografia + Bootstrap + Ícones -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Estilos do projeto -->
  <link href="/src/css/main.css" rel="stylesheet">
  <link href="/src/css/components.css" rel="stylesheet">
</head>
<body>

  <noscript>
    <div class="alert alert-warning m-0 text-center">
      Este site requer JavaScript habilitado para funcionar corretamente.
    </div>
  </noscript>

  <!-- ============== GATE (cronômetro) ============== -->
  <div id="gate-root"></div>

  <!-- ============== APP ============== -->
  <div id="app" class="d-none">

    <!-- Topbar -->
    <header class="topbar">
      <div class="wrap container">
        <div class="brand-strip">
          <img class="logo logo-conaprev" src="imagens/logos/logo-conaprev.svg" alt="CONAPREV">
          <img class="logo logo-govbr"    src="imagens/logos/logo-govbr.svg"    alt="Governo Federal">
          <img class="logo logo-amprev"   src="imagens/logos/logo-amprev.svg"   alt="AMPREV">
        </div>

        <nav class="links" aria-label="Contatos e administração">
          <a href="mailto:conaprev@previdencia.gov.br">
            <img class="icon icon-mail" src="imagens/icones/mail.svg" alt="">
            conaprev@previdencia.gov.br
          </a>

          <a href="tel:+556120215347">
            <img class="icon icon-phone" src="imagens/icones/phone.svg" alt="">
            (61) 2021-5347
          </a>

          <!-- Botão do menu (hambúrguer) -->
          <button class="menu-icon"
                  type="button"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#menuOffcanvas"
                  aria-label="Abrir menu">
            <i class="bi bi-list" aria-hidden="true"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Offcanvas do menu -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="menuOffcanvas" aria-labelledby="menuOffcanvasLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="menuOffcanvasLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
      </div>
      <div class="offcanvas-body">
        <nav class="menu-list">
          <a href="#" id="adminAccessBtn" class="menu-item">
            <i class="bi bi-gear" aria-hidden="true"></i>
            Administrador
          </a>
        </nav>
      </div>
    </div>

    <!-- HERO (selo em grid, alinhado ao meio) -->
    <section class="hero">
      <div class="hero-grid container container--narrow">
        <img class="amapa-badge" src="imagens/logos/amapa-badge.svg" alt="Amapá">
        <div class="inner">
          <h1>83ª Reunião Ordinária do</h1>
          <div class="brand-title">CONAPREV</div>

          <div class="info-line">
            <i class="bi bi-geo-alt" aria-hidden="true"></i>
            <span>Av. Ernestino Borges, 740 – Julião Ramos, Macapá – AP, CEP 68908-198</span>
          </div>
          <div class="info-line">
            <i class="bi bi-calendar-event" aria-hidden="true"></i>
            <span>Terça-feira, 02 de Dezembro de 2025 — das 8h30 às 17h30</span>
          </div>
          <div class="info-line">
            <i class="bi bi-calendar-event" aria-hidden="true"></i>
            <span>Quarta-feira, 03 de Dezembro de 2025 — das 8h30 às 13h</span>
          </div>

          <div class="chips" role="navigation" aria-label="Atalhos">
            <a class="chip" href="#" id="btnEmitirCert">
              <img class="icon-20" src="imagens/icones/certificado.svg" alt=""> Emitir certificado
            </a>
            <a class="chip" href="#" id="btnHospedagem">
              <img class="icon-20" src="imagens/icones/hospedagem.svg" alt=""> Sugestões de hospedagem
            </a>
            <a class="chip" href="#" id="btnOficio">
              <img class="icon-20" src="imagens/icones/oficio.svg" alt=""> Ofício de convocação
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- HOME -->
    <main class="container container--narrow py-5">
      <section id="home" class="mb-5" aria-label="Selecione seu perfil">
        <div class="row g-4 row-cols-1 row-cols-sm-2 row-cols-lg-5">

          <div class="col">
            <div class="card h-100 profile-card" data-profile="Conselheiro">
              <img src="imagens/cards/conselheiro.svg" class="card-img-top" alt="Conselheiro">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">Conselheiro</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 profile-card" data-profile="CNRPPS">
              <img src="imagens/cards/cnrpps.svg" class="card-img-top" alt="CNRPPS">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">CNRPPS</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 profile-card" data-profile="Palestrante">
              <img src="imagens/cards/palestrante.svg" class="card-img-top" alt="Palestrante">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">Palestrante</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 profile-card" data-profile="COPAJURE">
              <img src="imagens/cards/copajure.svg" class="card-img-top" alt="COPAJURE">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">COPAJURE</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 profile-card" data-profile="Staff">
              <img src="imagens/cards/staff.svg" class="card-img-top" alt="Staff">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">Staff</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

        </div>
      </section>
    </main>
  </div>

  <!-- Modal de Inscrição -->
  <div class="modal fade" id="modalInscricao" tabindex="-1" aria-labelledby="miTitle" aria-hidden="true" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="miTitle" class="modal-title">Inscrição — <span id="miPerfil">Perfil</span></h5>
          <span id="miStepLabel" class="ms-3 text-secondary small"></span>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>

        <div class="modal-body">
          <!-- Stepper -->
          <div class="mi-stepper d-flex gap-2 mb-3" aria-label="Etapas da inscrição">
            <div class="mi-step" data-step="1">CPF</div>
            <div class="mi-step" data-step="2">Dados</div>
            <div class="mi-step" data-step="3">Perfil</div>
            <div class="mi-step" data-step="4">Revisão</div>
            <div class="mi-step" data-step="5">Enviar</div>
            <div class="mi-step" data-step="6">Protocolo</div>
          </div>

          <form id="miForm" novalidate>
            <!-- Passo 1 -->
            <div class="mi-pane" data-step="1">
              <div class="row g-3">
                <div class="col-12 col-md-4">
                  <label class="form-label" for="miCpf">CPF *</label>
                  <input id="miCpf" name="cpf" class="form-control" inputmode="numeric" autocomplete="off" required>
                  <div class="invalid-feedback">Informe um CPF válido.</div>
                </div>
              </div>

              <!-- GRID DE ASSENTOS (só será exibido para Conselheiro via JS) -->
              <div id="miSeatsWrap" class="mt-3 d-none" aria-live="polite">
                <div class="d-flex align-items-center justify-content-between flex-wrap mb-2">
                  <h6 class="mb-0">Conselheiros inscritos</h6>
                  <div class="d-flex align-items-center gap-3">
                    <span class="small text-secondary">
                      Ocupados: <strong id="miSeatOcupados">0</strong> / <span id="miSeatTotal">62</span>
                    </span>
                    <span class="badge bg-success">Disponível</span>
                    <span class="badge bg-danger">Ocupado</span>
                  </div>
                </div>
                <div id="miSeatGrid" class="mi-seat-grid"></div>
              </div>
            </div>

            <!-- Passo 2: dados / conferência -->
            <div class="mi-pane" data-step="2">
              <!-- Barra de ações (alterna via JS) -->
              <div class="d-flex gap-2 mb-3">
                <button type="button" id="miBtnEditar"  class="btn btn-outline-secondary d-none">Editar dados</button>
                <button type="button" id="miBtnSalvar"  class="btn btn-success d-none">Salvar dados</button>
                <button type="button" id="miBtnConfirmar" class="btn btn-primary ms-auto d-none">Confirmar inscrição</button>
              </div>

              <!-- Painel de conferência (key/value) -->
              <div id="miDadosReview" class="vstack gap-2 d-none" aria-live="polite">
                <div id="miReviewKV"></div>
              </div>

              <!-- Form de edição (mesmos campos do cadastro novo) -->
              <div id="miDadosForm">
                <div class="row g-3">
                  <div class="col-12 col-md-6">
                    <label class="form-label" for="miNome">Nome *</label>
                    <input id="miNome" name="nome" class="form-control" autocomplete="name" required>
                    <div class="invalid-feedback">Obrigatório.</div>
                  </div>
                  <div class="col-12 col-md-6">
                    <label class="form-label" for="miEmail">E-mail *</label>
                    <input id="miEmail" name="email" type="email" class="form-control" autocomplete="email" required>
                    <div class="invalid-feedback">Obrigatório.</div>
                  </div>
                  <div class="col-12 col-md-4">
                    <label class="form-label" for="miCel">Celular</label>
                    <input id="miCel" name="cel" class="form-control" autocomplete="tel">
                  </div>
                  <div class="col-12 col-md-4">
                    <label class="form-label" for="miUf">UF/Sigla</label>
                    <input id="miUf" name="uf" class="form-control" maxlength="2">
                  </div>
                  <div class="col-12 col-md-4">
                    <label class="form-label" for="miOrgao">Órgão/Entidade</label>
                    <input id="miOrgao" name="orgao" class="form-control">
                  </div>

                  <!-- Campos extras quando for perfil Conselheiro -->
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miNomeCracha">Nome no Prisma/Crachá</label>
                    <input id="miNomeCracha" name="nomenoprismacracha" class="form-control" placeholder="Primeiro e último nome">
                  </div>
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miRepresent">Representatividade</label>
                    <input id="miRepresent" name="representatividade" class="form-control">
                  </div>
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miCargo">Cargo / Função</label>
                    <input id="miCargo" name="cargofuncao" class="form-control">
                  </div>
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miSiglaEntidade">Sigla da Entidade</label>
                    <input id="miSiglaEntidade" name="sigladaentidade" class="form-control">
                  </div>
                  <div class="col-12 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miEndereco">Endereço</label>
                    <input id="miEndereco" name="endereco" class="form-control">
                  </div>
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miEmailCons">E-mail Conselheiro(a)</label>
                    <input id="miEmailCons" name="emailconselheiroa" type="email" class="form-control">
                  </div>
                  <div class="col-12 col-md-6 d-none" data-extra="conselheiro">
                    <label class="form-label" for="miEmailSec">E-mail Secretário(a)</label>
                    <input id="miEmailSec" name="emailsecretarioa" type="email" class="form-control">
                  </div>
                </div>
              </div>
            </div>

            <!-- Passo 3: campos do perfil (renderizados dinamicamente) -->
            <div class="mi-pane" data-step="3">
              <div id="miPerfilContainer" class="row g-3"></div>
            </div>

            <!-- Passo 4: revisão geral -->
            <div class="mi-pane" data-step="4">
              <div id="miReview" class="vstack gap-2"></div>
            </div>

            <!-- Passo 5: envio -->
            <div class="mi-pane" data-step="5">
              <p>Ao avançar, sua inscrição será enviada para confirmação.</p>
            </div>

            <!-- Passo 6: protocolo -->
            <div class="mi-pane" data-step="6">
              <div class="alert alert-success">
                <div class="fw-bold">Inscrição confirmada!</div>
                Protocolo: <span id="miProtocolo">—</span>
              </div>
              <div class="d-flex gap-2">
                <a id="miBtnBaixar" class="btn btn-outline-primary" target="_blank" rel="noopener">Baixar comprovante (PDF)</a>
                <button type="button" id="miBtnReenviar" class="btn btn-outline-secondary">Reenviar e-mail</button>
              </div>
            </div>
          </form>
        </div>

        <div class="modal-footer">
          <button id="miBtnVoltar" class="btn btn-outline-secondary" type="button">Voltar</button>
          <button id="miBtnAvancar" class="btn btn-primary" type="button">Avançar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay Lottie (uso geral: buscar/salvar/sucesso/erro) -->
  <div id="miLottieOverlay" class="d-none" aria-hidden="true">
    <div class="mi-lottie-backdrop"></div>
    <div class="mi-lottie-card">
      <div id="miLottieHolder" class="mi-lottie-box" aria-label="Carregando"></div>
      <div id="miLottieMsg" class="mt-2 small text-center text-muted"></div>
    </div>
  </div>

  <!-- Modal de sucesso compacto -->
  <div class="modal fade" id="miOkModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="modal-title">Inscrição realizada</h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body text-center">
          <p class="mb-1">Sua inscrição na <strong>83ª Reunião Ordinária do CONAPREV</strong> foi realizada com sucesso.</p>
          <div class="fw-bold">Protocolo: <span id="miOkProtocolo">—</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ======================================================= -->

  <!-- Scripts base -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>

  <!-- Fallback rápido -->
  <script>
    window.API_BASE = window.API_BASE || 'http://localhost:3000';
    window.EVENTO = window.EVENTO || {
      INICIO: '2025-09-22T08:00:00-03:00',
      FIM:    '2025-08-13T13:00:00-03:00',
      LOCAL:  'Brasília/DF'
    };
  </script>

  <!-- Config + Gate -->
  <script type="module" src="/src/js/config.js"></script>
  <script type="module" src="/src/js/gate.js"></script>

  <!-- Utils -->
  <script src="/src/js/ui.js"></script>
  <script src="/src/js/cpf.js"></script>
  <script src="/src/js/forms.js"></script>

  <!-- API helper -->
  <script type="module" src="/src/js/api.js"></script>

  <!-- Fluxo multi-passos -->
  <script src="/src/js/steps.js"></script>
</body>
</html>
