<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CONAPREV 83 — Inscrições (Convidados & Patrocinadores)</title>
  <meta name="description" content="Inscrições de Convidados e Patrocinadores para a 83ª Reunião Ordinária do CONAPREV. Informações, hospedagem e ofício de convocação." />

  <!-- Tipografia + Bootstrap + Ícones -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Favicon (SVG) -->
  <link rel="icon" type="image/svg+xml" href="imagens/logos/logo-conaprev.svg">
  <!-- Fallbacks -->
  <link rel="icon" type="image/png" sizes="32x32"  href="imagens/logos/logo-conaprev-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="imagens/logos/logo-conaprev-192.png">
  <link rel="apple-touch-icon" sizes="180x180" href="imagens/logos/logo-conaprev-180.png">

  <meta name="theme-color" content="#0b4d49">

  <!-- Estilos do projeto -->
  <link href="/src/css/main.css" rel="stylesheet">
  <link href="/src/css/components.css" rel="stylesheet">
</head>
<body>

  <noscript>
    <div class="alert alert-warning m-0 text-center">
      Este site requer JavaScript habilitado para funcionar corretamente.
    </div>
  </noscript>

  <!-- ============== GATE (não usado aqui) ============== -->
  <div id="gate-root"></div>

  <!-- ============== APP ============== -->
  <div id="app" class="d-none">

    <!-- Topbar -->
    <header class="topbar">
      <div class="wrap container">
        <div class="brand-strip">
          <img class="logo logo-conaprev" src="imagens/logos/logo-conaprev.svg" alt="CONAPREV">
          <img class="logo logo-govbr"    src="imagens/logos/logo-govbr.svg"    alt="Governo Federal">
          <img class="logo logo-amprev"   src="imagens/logos/logo-amprev.svg"   alt="AMPREV">
        </div>

        <nav class="links" aria-label="Administração">
          <a href="mailto:conaprev@previdencia.gov.br">
            <img class="icon icon-mail" src="imagens/icones/mail.svg" alt="">
            conaprev@previdencia.gov.br
          </a>

          <a href="tel:+556120215347">
            <img class="icon icon-phone" src="imagens/icones/phone.svg" alt="">
            (61) 2021-5347
          </a>
          <!-- Apenas o hambúrguer na topbar móvel; links vão no footer mobile -->
          <button class="menu-icon"
                  type="button"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#menuOffcanvas"
                  aria-label="Abrir menu">
            <i class="bi bi-list" aria-hidden="true"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Offcanvas do menu -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="menuOffcanvas" aria-labelledby="menuOffcanvasLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="menuOffcanvasLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
      </div>
      <div class="offcanvas-body">
        <nav class="menu-list">
          <a href="#" id="adminAccessBtn" class="menu-item d-flex align-items-center gap-2">
            <i class="bi bi-gear" aria-hidden="true"></i>
            <span>Administrador</span>
            <!-- Badge de notificações -->
            <span id="adminNotifBadge" class="badge rounded-pill bg-danger-subtle text-danger-emphasis ms-auto d-none">0</span>
          </a>
        </nav>
      </div>
    </div>

    <!-- HERO -->
    <section class="hero">
      <div class="hero-grid container container--narrow">
        <img class="amapa-badge" src="imagens/logos/amapa-badge.svg" alt="Amapá">
        <div class="inner">
          <h1>83ª Reunião Ordinária do</h1>
          <div class="brand-title">CONAPREV</div>

          <div class="info-line">
            <i class="bi bi-geo-alt" aria-hidden="true"></i>
            <span>Av. Ernestino Borges, 740 – Julião Ramos, Macapá – AP, CEP 68908-198</span>
          </div>
          <div class="info-line">
            <i class="bi bi-calendar-event" aria-hidden="true"></i>
            <span>Terça-feira, 02 de Dezembro de 2025 — das 8h30 às 17h30</span>
          </div>
          <div class="info-line">
            <i class="bi bi-calendar-event" aria-hidden="true"></i>
            <span>Quarta-feira, 03 de Dezembro de 2025 — das 8h30 às 13h</span>
          </div>

          <div class="chips" role="navigation" aria-label="Atalhos">
            <a class="chip" href="#" id="btnEmitirCert">
              <img class="icon-20" src="imagens/icones/certificado.svg" alt=""> Emitir certificado
            </a>
            <a class="chip" href="/hospedagem.html" target="_blank" id="btnHospedagem">
              <img class="icon-20" src="imagens/icones/hospedagem.svg" alt=""> Sugestões de hospedagem
            </a>
            <a class="chip" href="/oficios/oficio-convocacao.pdf" target="_blank" rel="noopener">
              <img class="icon-20" src="imagens/icones/oficio.svg" alt=""> Ofício de convocação
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- HOME -->
    <main class="container container--narrow py-5">
      <section id="home" class="mb-5" aria-label="Selecione seu perfil">
        <!-- Aqui mostramos APENAS Convidado e Patrocinador -->
        <div class="row g-4 row-cols-1 row-cols-sm-2 row-cols-lg-2">

          <div class="col">
            <div class="card h-100 profile-card" data-profile="Convidado">
              <img src="imagens/cards/convidado.svg" class="card-img-top" alt="Convidado">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">Convidado</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 profile-card" data-profile="Patrocinador">
              <img src="imagens/cards/patrocinador.svg" class="card-img-top" alt="Patrocinador">
              <div class="card-body d-flex flex-column text-center">
                <h5 class="card-title">Patrocinador</h5>
                <button class="btn btn-outline-primary mt-auto select-profile">Selecionar</button>
              </div>
            </div>
          </div>

        </div>
      </section>
    </main>
  </div>

  <!-- Modal de Inscrição (reutiliza o mesmo fluxo/JS) -->
  <div class="modal fade" id="modalInscricao" tabindex="-1" aria-labelledby="miTitle" aria-hidden="true" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="miTitle" class="modal-title">Inscrição — <span id="miPerfil">Perfil</span></h5>
          <span id="miStepLabel" class="ms-3 text-secondary small"></span>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>

        <div class="modal-body">
          <!-- Stepper -->
          <div class="mi-stepper d-flex gap-2 mb-3" aria-label="Etapas da inscrição">
            <div class="mi-step" data-step="1">CPF</div>
            <div class="mi-step" data-step="2">Dados</div>
            <div class="mi-step" data-step="3">Perfil</div>
            <div class="mi-step" data-step="4">Revisão</div>
            <div class="mi-step" data-step="5">Enviar</div>
            <div class="mi-step" data-step="6">Protocolo</div>
          </div>

          <form id="miForm" novalidate>
            <!-- Passo 1 -->
            <div class="mi-pane" data-step="1">
              <div class="row g-3">
                <div class="col-12 col-md-4">
                  <label class="form-label" for="miCpf">CPF *</label>
                  <input id="miCpf" name="cpf" class="form-control" inputmode="numeric" autocomplete="off" required>
                  <div class="invalid-feedback">Informe um CPF válido.</div>
                </div>
              </div>
            </div>

            <!-- Passo 2 -->
            <div class="mi-pane" data-step="2">
              <div class="text-muted">Faça a pesquisa do CPF para carregar ou iniciar o cadastro.</div>
            </div>

            <!-- Passo 3 -->
            <div class="mi-pane" data-step="3">
              <div id="miPerfilContainer" class="row g-3"></div>
            </div>

            <!-- Passo 4 -->
            <div class="mi-pane" data-step="4">
              <div id="miReview" class="vstack gap-2"></div>
            </div>

            <!-- Passo 5 -->
            <div class="mi-pane" data-step="5">
              <p>Ao avançar, sua inscrição será enviada para confirmação.</p>
            </div>

            <!-- Passo 6 -->
            <div class="mi-pane" data-step="6">
              <div class="alert alert-success">
                <div class="fw-bold">Inscrição confirmada!</div>
                Protocolo: <span id="miProtocolo">—</span>
              </div>
            </div>
          </form>
        </div>

        <div class="modal-footer">
          <button id="miBtnVoltar" class="btn btn-outline-secondary" type="button">Voltar</button>
          <button id="miBtnAvancar" class="btn btn-primary" type="button">Avançar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay Lottie -->
  <div id="miLottieOverlay" class="d-none" aria-hidden="true">
    <div class="mi-lottie-backdrop"></div>
    <div class="mi-lottie-card">
      <div id="miLottieHolder" class="mi-lottie-box" aria-label="Carregando"></div>
      <div id="miLottieMsg" class="mt-2 small text-center text-muted"></div>
    </div>
  </div>

  <!-- ========== MODAL: Login do Administrador ========== -->
  <div class="modal fade" id="adminAuthModal" tabindex="-1" aria-hidden="true" aria-labelledby="adminAuthTitle">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <form id="adminAuthForm" autocomplete="off">
          <div class="modal-header">
            <h5 class="modal-title" id="adminAuthTitle">
              <i class="bi bi-shield-lock" aria-hidden="true"></i> Acesso do Administrador
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="adminPass" class="form-label">Senha</label>
              <input id="adminPass" type="password" class="form-control" required autocomplete="new-password" />
              <div class="form-text">Informe a senha administrativa para continuar.</div>
            </div>
            <div id="adminAuthMsg" class="small text-danger d-none">Senha inválida.</div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">
              Entrar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ========== MODAL: Acompanhar Inscrições ========== -->
  <div class="modal fade" id="adminMonitorModal" tabindex="-1" aria-hidden="true" aria-labelledby="adminMonitorTitle">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="adminMonitorTitle" class="modal-title d-flex align-items-center gap-2">
            <i class="bi bi-people" aria-hidden="true"></i>
            Acompanhar inscrições
            <span class="position-relative ms-2">
              <i class="bi bi-bell-fill" aria-hidden="true"></i>
              <span id="adminNotifCount" class="badge rounded-pill bg-danger position-absolute top-0 start-100 translate-middle">0</span>
            </span>
          </h5>

          <div class="d-flex align-items-center gap-2">
            <button id="adminLogoutBtn" type="button" class="btn btn-outline-danger btn-sm">
              <i class="bi bi-box-arrow-right" aria-hidden="true"></i> Sair
            </button>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
        </div>


        <div class="modal-body">
          <!-- Toolbar -->
          <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
            <div class="d-flex align-items-center gap-2">
              <label for="adminPerfilSelect" class="form-label m-0">Perfil:</label>
              <select id="adminPerfilSelect" class="form-select form-select-sm">
                <option value="Convidado">Convidado</option>
                <option value="Patrocinador">Patrocinador</option>
                <!-- se quiser listar todos os perfis aqui, basta incluir outros options -->
              </select>
            </div>

            <div class="ms-auto d-flex flex-wrap align-items-center gap-2">
              <div class="input-group input-group-sm" style="min-width: 260px">
                <span class="input-group-text"><i class="bi bi-search" aria-hidden="true"></i></span>
                <input id="adminSearch" type="search" class="form-control" placeholder="Buscar por CPF ou Nome…" />
              </div>
              <button id="adminRefreshBtn" type="button" class="btn btn-outline-secondary btn-sm">
                <i class="bi bi-arrow-repeat" aria-hidden="true"></i> Atualizar
              </button>
              <button id="adminDownloadBtn" type="button" class="btn btn-outline-primary btn-sm">
                <i class="bi bi-download" aria-hidden="true"></i> Baixar dashboard
              </button>
            </div>
          </div>

          <!-- Abas -->
          <ul class="nav nav-tabs mb-3" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="tabAdminAtivos" data-bs-toggle="tab" data-bs-target="#paneAdminAtivos" type="button" role="tab" aria-controls="paneAdminAtivos" aria-selected="true">
                Ativos
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="tabAdminFinalizados" data-bs-toggle="tab" data-bs-target="#paneAdminFinalizados" type="button" role="tab" aria-controls="paneAdminFinalizados" aria-selected="false">
                Finalizados
              </button>
            </li>
          </ul>

          <div class="tab-content">
            <!-- Pane: Ativos -->
            <div class="tab-pane fade show active" id="paneAdminAtivos" role="tabpanel" aria-labelledby="tabAdminAtivos" tabindex="0">
              <div id="adminAtivosList" class="vstack gap-2"></div>
              <div id="adminAtivosPager" class="d-flex justify-content-between align-items-center mt-3"></div>
            </div>

            <!-- Pane: Finalizados -->
            <div class="tab-pane fade" id="paneAdminFinalizados" role="tabpanel" aria-labelledby="tabAdminFinalizados" tabindex="0">
              <div id="adminFinalizadosList" class="vstack gap-2"></div>
              <div id="adminFinalizadosPager" class="d-flex justify-content-between align-items-center mt-3"></div>
            </div>
          </div>

          <!-- Hint -->
          <div class="mt-3 small text-muted">
            <i class="bi bi-hand-index-thumb" aria-hidden="true"></i>
            Clique na mão para marcar <strong>Conferido</strong> (fica verde) e mover o registro para <em>Finalizados</em>.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toasts (Admin) -->
  <div id="adminToastContainer" class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1080;"></div>


  <!-- Footer (mobile) -->
  <footer class="site-footer">
    <div class="footer-links">
      <a class="footer-link" href="mailto:conaprev@previdencia.gov.br">
        <img class="icon" src="imagens/icones/mail.svg" alt="">
        <span>conaprev@previdencia.gov.br</span>
      </a>
      <a class="footer-link" href="tel:+556120215347">
        <img class="icon" src="imagens/icones/phone.svg" alt="">
        <span>(61) 2021-5347</span>
      </a>
    </div>
  </footer>

  <!-- Scripts base -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js" defer></script>

  <!-- Fallback rápido -->
  <script>
    window.API_BASE = window.API_BASE || 'http://localhost:3000';
    window.EVENTO = window.EVENTO || {
      INICIO: '2025-09-22T08:00:00-03:00',
      FIM:    '2025-08-13T13:00:00-03:00',
      LOCAL:  'Brasília/DF'
    };
  </script>


  <!-- Config (sem gate) -->
  <script src="/src/js/config.js" defer></script>

  <!-- Utils -->
  <script src="/src/js/ui.js" defer></script>
  <script src="/src/js/cpf.js" defer></script>
  <script src="/src/js/forms.js" defer></script>

  <!-- API helper (stub) -->
  <script src="/src/js/api.js" defer></script>

  <!-- Fluxo multi-passos (reutilizado) -->
  <script src="/src/js/steps.js" defer></script>

  <!-- Admin -->
  <script src="/src/js/admin.js" defer></script>

  <script>
    // Força abrir o app e remove qualquer vestígio do gate
    (function () {
      const show = () => {
        document.getElementById('app')?.classList.remove('d-none');
        document.body.classList.remove('gate-active');
        document.getElementById('gate-root')?.remove();
      };
      show();
      window.addEventListener('DOMContentLoaded', show);
      window.addEventListener('load', show);
    })();
  </script>

</body>
</html>
